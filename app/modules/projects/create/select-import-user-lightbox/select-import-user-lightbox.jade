tg-lightbox-close(on-close="vm.onClose()")

.form(ng-if="vm.visible")
    h2.title(translate="PROJECT.IMPORT.WHO_IS")

    .candidate-user
        .user-list-avatar
            a(
                href=""
                title="{{'COMMON.ASSIGNED_TO' | translate}}"
            )
                img(
                    ng-src="{{vm.user.avatar}}"
                )
        a.user-list-name(
            href=""
            title="{{vm.user.name}}"
        ) {{vm.user.name}}

    div(ng-if="vm.mode == 'mail'")
        fieldset
            label(
                translate="PROJECT.IMPORT.WRITE_EMAIL_LABEL"
                for="user-name"
            )
            input(
                name="user-name"
                type="text",
                data-maxlength="500",
                ng-model="vm.userEmail"
            )

        .search-user-mode
            p
                a(
                    href=""
                    ng-click="vm.mode = 'search'"
                ) {{'PROJECT.IMPORT.SEARCH_CONTACT' | translate}}

    div(ng-if="vm.mode == 'search'")
        fieldset
            input(
                type="text",
                data-maxlength="500",
                placeholder="{{'LIGHTBOX.ASSIGNED_TO.SEARCH' | translate}}",
                ng-model="vm.usersSearch"
            )
        .assigned-to-list
            .user-list-single(
                ng-repeat="user in vm.users | toMutable | filter: vm.usersSearch | limitTo: 5",
                ng-click="vm.onSelectUser({user: user})"
            )
                .user-list-avatar
                    a(
                        href="#"
                        title="{{'COMMON.ASSIGNED_TO.TITLE' | translate}}"
                    )
                        img(tg-avatar="user")
                a.user-list-name(
                    href=""
                    title="{{user.full_name_display}}"
                ) {{user.full_name_display}}

            .more-users
                span(translate="COMMON.ASSIGNED_TO.TOO_MANY")

        .search-user-mode
            p
                a(
                    href=""
                    ng-click="vm.mode = 'mail'"
                ) {{'PROJECT.IMPORT.WRITE_EMAIL' | translate}}
